# Тестовый сценарий: Flow создания отзыва

## Цель
Протестировать полный flow от поиска организации до создания отзыва и проверки уведомлений.

## Предусловия
- Организация создана и видна публично
- Пользователь НЕ авторизован
- Владелец организации зарегистрирован

## Шаги тестирования

### Шаг 1: Поиск организации
**Действие:**
1. Открыть главную страницу
2. Перейти в "Каталог производителей"
3. Ввести название организации в поиск
4. Нажать "Найти"

**Ожидаемый результат:**
- Организация найдена и отображается в списке
- Есть кнопка "Посмотреть"

**Статус:** ⏳ Требует тестирования

---

### Шаг 2: Переход на страницу организации
**Действие:**
1. Нажать "Посмотреть" на найденной организации

**Ожидаемый результат:**
- Открывается страница организации с ID в URL
- Отображается название, описание, контакты
- Есть секция "Отзывы"
- Есть кнопка "Оставить отзыв"

**Статус:** ⏳ Требует тестирования

---

### Шаг 3: Нажатие "Оставить отзыв" → редирект на регистрацию
**Действие:**
1. Нажать кнопку "Оставить отзыв"

**Ожидаемый результат:**
- Происходит редирект на `/register?returnUrl=/org/{id}/review`
- В URL присутствует параметр `returnUrl`
- Отображается форма регистрации

**Статус:** ⏳ Требует тестирования

---

### Шаг 4: Регистрация → возврат на страницу отзыва
**Действие:**
1. Заполнить форму регистрации (тип: "user")
2. Нажать "Зарегистрироваться"
3. Дождаться завершения регистрации

**Ожидаемый результат:**
- Регистрация успешна
- Происходит автоматический редирект на `/org/{id}/review`
- Открывается форма создания отзыва
- В форме отображается название организации

**Статус:** ⏳ Требует тестирования

---

### Шаг 5: Создание отзыва
**Действие:**
1. Выбрать оценку (звезды)
2. Заполнить заголовок (опционально)
3. Заполнить текст отзыва (минимум 10 символов)
4. Нажать "Отправить отзыв"

**Ожидаемый результат:**
- Отзыв успешно создан
- Происходит редирект на страницу организации `/org/{id}`
- Отображается сообщение об успехе (или просто редирект)

**Статус:** ⏳ Требует тестирования

---

### Шаг 6: Отображение отзыва на странице организации
**Действие:**
1. После создания отзыва проверить страницу организации
2. Обновить страницу (F5)

**Ожидаемый результат:**
- В секции "Отзывы" отображается созданный отзыв
- Отображается оценка (звезды)
- Отображается заголовок (если был указан)
- Отображается текст отзыва
- Отображается дата создания
- Обновляется средняя оценка (если есть другие отзывы)

**Статус:** ⏳ Требует тестирования

---

### Шаг 7: Уведомление для владельца бизнеса
**Действие:**
1. Выйти из аккаунта пользователя
2. Войти как владелец организации
3. Перейти в "Уведомления" или "Кабинет"

**Ожидаемый результат:**
- В списке уведомлений есть уведомление "У вас новый отзыв"
- Уведомление содержит информацию о рейтинге
- Можно перейти к отзыву из уведомления

**Статус:** ⏳ Требует тестирования

---

### Шаг 8: Ответ на отзыв
**Действие:**
1. Войти как владелец организации
2. Перейти в "Отзывы" в дашборде
3. Найти созданный отзыв
4. Нажать "Ответить" (если функция реализована)

**Ожидаемый результат:**
- Есть возможность ответить на отзыв
- Ответ сохраняется
- Ответ отображается под отзывом на публичной странице

**Статус:** ⚠️ Функция еще не реализована

---

## Известные проблемы

1. API endpoint `/api/public/organizations/{id}` возвращает 500 - требуется проверка после деплоя
2. Функция ответа на отзыв не реализована

## Тестовые данные

**Организация:**
- ID: `31df86da-a3ca-4261-a159-39d7bbc7423e`
- Название: "Мастерская «Северный Фарфор»"
- URL: `https://chestnoru-production.up.railway.app/org/31df86da-a3ca-4261-a159-39d7bbc7423e`

**Тестовый пользователь для отзыва:**
- Email: `reviewer@test.com`
- Password: `reviewer123`

**Владелец организации:**
- Email: `producer1@test.com`
- Password: `producer123`

